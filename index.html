<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PRECISE PREDICTOR V10</title>
    <style>
        :root {
            --bg-dark: #0f1115;
            --card-bg: #1a1d23;
            --p-blue: #0084ff;
            --b-red: #ff3b30;
            --t-green: #34c759;
            --gold: #ffcc00;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Inter', -apple-system, sans-serif; }
        
        body { 
            background: var(--bg-dark); 
            color: #fff; 
            margin: 0; 
            padding: 15px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh;
            overflow-y: auto; 
        }

        .container { width: 100%; max-width: 420px; position: relative; padding-bottom: 30px; }
        
        /* Header */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; width: 100%; }
        .target-goal-display { font-size: 13px; color: var(--gold); font-weight: 800; border: 2px solid var(--gold); padding: 6px 14px; border-radius: 25px; background: rgba(255, 204, 0, 0.1); }
        /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πà‡∏õ‡∏•‡∏≤ */
        .settings-dots { font-size: 28px; cursor: pointer; color: #fff; opacity: 0.7; transition: 0.3s; padding: 0 10px; }
        .settings-dots:hover { opacity: 1; }

        .display-area { margin: 5px 0 25px; display: flex; flex-direction: column; align-items: center; width: 100%; }
        
        .target-rect {
            width: 100%; 
            aspect-ratio: 1.8 / 1; 
            border-radius: 40px; 
            border: 6px solid #222; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            background: #111; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        
        #targetTxt { font-size: 140px; font-weight: 900; line-height: 1; letter-spacing: -2px; color: #ffffff; margin: 0; }
        #betVal { font-size: 38px; color: #ffffff; font-weight: 800; margin-top: -5px; }
        
        .mode-label { margin-top: 15px; font-size: 14px; color: var(--gold); font-weight: bold; text-transform: uppercase; letter-spacing: 2px; }
        
        .bg-P { background: var(--p-blue) !important; border-color: #5bb2ff !important; box-shadow: 0 10px 40px rgba(0, 132, 255, 0.5); }
        .bg-B { background: var(--b-red) !important; border-color: #ff7e79 !important; box-shadow: 0 10px 40px rgba(255, 59, 48, 0.5); }

        .stats-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; width: 100%; }
        .mini-stats { background: #1a1d23; padding: 10px 15px; border-radius: 15px; font-size: 12px; font-weight: 700; border: 1px solid #333; display: flex; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .btn-history { background: rgba(255,204,0,0.1); color: var(--gold); border: 1px solid var(--gold); padding: 10px 16px; border-radius: 12px; font-size: 12px; font-weight: 800; cursor: pointer; }

        .plate { background: #000; border-radius: 15px; padding: 12px; width: 100%; border: 1px solid #222; display: grid; grid-template-rows: repeat(6, 1fr); grid-template-columns: repeat(12, 1fr); grid-auto-flow: column; gap: 5px; aspect-ratio: 12 / 6; box-shadow: inset 0 0 15px rgba(0,0,0,0.6); }
        .dot { aspect-ratio: 1; border-radius: 50%; background: #1a1d23; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 900; }
        .dot.P { background: var(--p-blue); color: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.4); }
        .dot.B { background: var(--b-red); color: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.4); }
        .dot.T { background: var(--t-green); color: #fff; }

        .input-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; width: 100%; margin: 25px 0 15px; }
        .card-btn { height: 90px; border-radius: 24px; border: none; font-size: 36px; font-weight: 900; cursor: pointer; background: var(--card-bg); color: #fff; box-shadow: 0 6px 0 #000; transition: 0.1s; }
        .card-btn:active { transform: translateY(4px); box-shadow: 0 2px 0 #000; }

        .util-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; }
        .btn-util { background: #252a30; border: none; color: #eee; padding: 18px; border-radius: 18px; font-size: 16px; font-weight: 800; cursor: pointer; box-shadow: 0 4px 0 #000; }
        .btn-util:active { transform: translateY(2px); box-shadow: 0 2px 0 #000; }

        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.92); z-index: 2000; backdrop-filter: blur(12px); align-items: center; justify-content: center; }
        .modal-content { background: #1e2227; padding: 30px; border-radius: 30px; width: 90%; max-width: 360px; text-align: center; }
        .input-text { width: 100%; background: #000; border: 1px solid #444; color: var(--gold); padding: 16px; border-radius: 15px; margin: 10px 0 20px; font-size: 20px; text-align: center; font-weight: 800; }
        .strat-item { background: #2c323a; padding: 14px; border-radius: 15px; font-size: 14px; cursor: pointer; border: 1px solid transparent; text-align: center; color: #888; margin-bottom: 10px; }
        .strat-item.active { background: var(--p-blue); color: #fff; font-weight: bold; border-color: #fff; }
        
        #historyPanel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); z-index: 3000; padding: 25px; overflow-y: auto; }
        .history-item { padding: 20px; border-radius: 20px; background: rgba(255,255,255,0.03); margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border-left: 8px solid #333; }
        .history-win { border-left-color: var(--t-green); }
        .history-loss { border-left-color: var(--b-red); }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div id="targetDisplay" class="target-goal-display">‡πÄ‡∏õ‡πâ‡∏≤: 0 / 0</div>
        <div class="settings-dots" onclick="toggleSettings()">&#8942;</div>
    </div>

    <div class="display-area">
        <div id="target" class="target-rect">
            <span id="targetTxt">-</span>
            <span id="betVal"></span>
        </div>
        <div id="modeLabel" class="mode-label">FOLLOW 2 LOSS</div>
    </div>

    <div class="stats-bar">
        <div class="mini-stats">
            <span style="color:#777">ALL:<span id="cA" style="color:#fff">0</span></span>
            <span style="color:var(--p-blue)">P:<span id="cP">0</span></span>
            <span style="color:var(--t-green)">T:<span id="cT">0</span></span>
            <span style="color:var(--b-red)">B:<span id="cB">0</span></span>
        </div>
        <button class="btn-history" onclick="toggleHistory()">üìú ‡∏ä‡∏ô‡∏∞: <span id="winCountDisplay">0</span></button>
    </div>

    <div id="plate" class="plate"></div>

    <div class="input-grid">
        <button class="card-btn" style="color:var(--p-blue)" onclick="add('P')">P</button>
        <button class="card-btn" style="color:var(--t-green)" onclick="add('T')">T</button>
        <button class="card-btn" style="color:var(--b-red)" onclick="add('B')">B</button>
    </div>

    <div class="util-grid">
        <button class="btn-util" onclick="undo()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button class="btn-util" onclick="reset()">‡∏•‡πâ‡∏≤‡∏á</button>
    </div>
</div>

<div id="settingsPanel" class="modal-overlay">
    <div class="modal-content">
        <b style="color:var(--gold); font-size: 22px;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</b>
        
        <div style="font-size:13px; color:#888; margin: 25px 0 5px; text-align: left;">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</div>
        <input type="number" id="profitTargetInput" class="input-text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç">

        <div style="font-size:13px; color:#888; margin: 10px 0 5px; text-align: left;">‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡πÉ‡∏ä‡πâ - ‡∏Ñ‡∏±‡πà‡∏ô)</div>
        <input type="text" id="moneyPlanInput" class="input-text" placeholder="5-5-10-10">

        <div style="font-size:13px; color:#888; margin: 10px 0 5px; text-align: left;">‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
        <div id="strategyList">
            <div class="strat-item" id="s0" onclick="setStrategy(0)">Standard (2^1)</div>
            <div class="strat-item" id="s1" onclick="setStrategy(1)">‡∏ï‡∏≤‡∏° 2 ‡∏ñ‡∏π‡∏Å (Follow 2 Wins)</div>
            <div class="strat-item active" id="s2" onclick="setStrategy(2)">‡∏ï‡∏≤‡∏° 2 ‡∏ú‡∏¥‡∏î (Follow 2 Loss)</div>
        </div>
        
        <button class="btn-util" style="width:100%; background:var(--p-blue); color:#fff; margin-top:20px; border:none;" onclick="confirmSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    </div>
</div>

<div id="historyPanel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 30px;">
        <h2 style="color:var(--gold); margin:0; font-size: 24px;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</h2>
        <span onclick="toggleHistory()" style="font-size:40px; cursor:pointer;">‚úï</span>
    </div>
    <div id="historyList"></div>
</div>

<script>
    let logs = [];
    let resultHistory = [];
    let undoStack = [];
    let moneyPlan = [5, 5, 10, 10, 20, 20];
    let profitTarget = 0;
    let currentIndex = 0;
    let recoveryMode = false;
    let currentStrategy = 2;
    let lockedDNA = -1;
    let blockAfterLoss = false;
    let goalReachedAlerted = false; // ‡∏Å‡∏±‡∏ô alert ‡πÄ‡∏î‡πâ‡∏á‡∏ã‡πâ‡∏≥‡πÜ
    const profiles = [['M'], ['T']];

    function saveState() {
        undoStack.push(JSON.stringify({
            logs: [...logs],
            resultHistory: [...resultHistory],
            currentIndex,
            recoveryMode,
            lockedDNA,
            blockAfterLoss,
            goalReachedAlerted
        }));
        if (undoStack.length > 50) undoStack.shift();
    }

    function undo() {
        if (undoStack.length === 0) return;
        let state = JSON.parse(undoStack.pop());
        logs = state.logs;
        resultHistory = state.resultHistory;
        currentIndex = state.currentIndex;
        recoveryMode = state.recoveryMode;
        lockedDNA = state.lockedDNA;
        blockAfterLoss = state.blockAfterLoss;
        goalReachedAlerted = state.goalReachedAlerted;
        render();
    }

    function add(v) {
        saveState();
        if (v !== 'T') {
            if(blockAfterLoss) blockAfterLoss = false;
            if (lockedDNA !== -1) {
                const fullText = document.getElementById('targetTxt').innerText;
                const currentPredict = fullText.slice(-1);
                const isWin = (v === currentPredict);
                
                let betAmount = recoveryMode ? (moneyPlan[currentIndex] + (moneyPlan[currentIndex+1]||0)) : moneyPlan[currentIndex];

                resultHistory.push({
                    round: resultHistory.length + 1,
                    predict: currentPredict,
                    isWin: isWin,
                    amount: betAmount,
                    stepIdx: currentIndex + 1
                });

                if (isWin) {
                    let currentStep = Math.floor(currentIndex / 2);
                    if (currentStep > 0) {
                        recoveryMode = true; 
                        currentIndex = (currentStep - 1) * 2; 
                    } else {
                        currentIndex = 0;
                        recoveryMode = false;
                    }
                } else {
                    currentIndex++;
                    if (currentIndex >= moneyPlan.length) {
                        currentIndex = 0;
                        recoveryMode = false;
                    }
                    lockedDNA = -1;
                    blockAfterLoss = true;
                }
            }
        }
        logs.push(v);
        render();
    }

    function render() {
        const plate = document.getElementById('plate');
        plate.innerHTML = "";
        let p=0, b=0, t=0;
        logs.slice(-72).forEach(v => {
            const d = document.createElement('div'); d.className = `dot ${v}`; d.innerText = v;
            plate.appendChild(d);
            if(v==='P') p++; if(v==='B') b++; if(v==='T') t++;
        });
        for(let i=logs.length; i<72; i++) plate.appendChild(document.createElement('div')).className = 'dot';

        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
        let currentProfit = resultHistory.reduce((sum, item) => {
            return item.isWin ? sum + item.amount : sum - item.amount;
        }, 0);

        // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
        if (profitTarget > 0 && currentProfit >= profitTarget && !goalReachedAlerted) {
            goalReachedAlerted = true;
            setTimeout(() => alert("‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏£‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß üí∞"), 100);
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏õ‡πâ‡∏≤
        const targetDisplay = document.getElementById('targetDisplay');
        const profitColor = currentProfit >= 0 ? 'var(--t-green)' : 'var(--b-red)';
        targetDisplay.innerHTML = `‡πÄ‡∏õ‡πâ‡∏≤: <span style="color:${profitColor}">${currentProfit}</span> / ${profitTarget}`;

        document.getElementById('cA').innerText = logs.length;
        document.getElementById('cP').innerText = p;
        document.getElementById('cT').innerText = t;
        document.getElementById('cB').innerText = b;
        document.getElementById('winCountDisplay').innerText = resultHistory.filter(h => h.isWin).length;

        const clean = logs.filter(x => x !== 'T');
        const targetTxt = document.getElementById('targetTxt');
        const betVal = document.getElementById('betVal');
        const targetRect = document.getElementById('target');

        if (lockedDNA === -1 && clean.length >= 4 && !blockAfterLoss) {
            for (let d = 0; d < 2; d++) {
                let res0 = checkPattern(clean, d);
                let res1 = checkPattern(clean.slice(0, -1), d);
                if (currentStrategy === 0 && res0) { lockedDNA = d; break; }
                else if (currentStrategy === 1 && res0 && res1) { lockedDNA = d; break; } 
                else if (currentStrategy === 2 && !res0 && !res1) { lockedDNA = d; break; } 
            }
        }

        if (lockedDNA !== -1 && clean.length > 0) {
            let lastRes = clean[clean.length-1];
            let nextPredict = (profiles[lockedDNA][0] === 'M') ? lastRes : (lastRes === 'P' ? 'B' : 'P');
            targetTxt.innerText = `${currentIndex + 1}${nextPredict}`;
            let amount = recoveryMode ? (moneyPlan[currentIndex] + (moneyPlan[currentIndex+1] || 0)) : moneyPlan[currentIndex];
            betVal.innerText = amount;
            targetRect.className = `target-rect bg-${nextPredict}`;
        } else {
            targetTxt.innerText = "-";
            betVal.innerText = "";
            targetRect.className = "target-rect";
        }
    }

    function checkPattern(cleanData, profileIdx) {
        if (cleanData.length < 2) return false;
        let last = cleanData[cleanData.length - 1];
        let prev = cleanData[cleanData.length - 2];
        let predict = (profiles[profileIdx][0] === 'M') ? prev : (prev === 'P' ? 'B' : 'P');
        return predict === last;
    }

    function setStrategy(id) {
        currentStrategy = id;
        document.querySelectorAll('#strategyList .strat-item').forEach(x => x.classList.remove('active'));
        document.getElementById(`s${id}`).classList.add('active');
        const labels = ["STANDARD 2^1", "FOLLOW 2 WINS", "FOLLOW 2 LOSS"];
        document.getElementById('modeLabel').innerText = labels[id];
        lockedDNA = -1; currentIndex = 0; recoveryMode = false; blockAfterLoss = false; render();
    }

    function toggleSettings() {
        const p = document.getElementById('settingsPanel');
        p.style.display = p.style.display === 'flex' ? 'none' : 'flex';
        document.getElementById('moneyPlanInput').value = moneyPlan.join('-');
        document.getElementById('profitTargetInput').value = profitTarget;
    }

    function confirmSettings() {
        const val = document.getElementById('moneyPlanInput').value;
        const targetVal = document.getElementById('profitTargetInput').value;
        if(val) moneyPlan = val.split('-').map(Number).filter(n => !isNaN(n) && n > 0);
        if(targetVal) {
            profitTarget = parseInt(targetVal) || 0;
            goalReachedAlerted = false; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
        }
        toggleSettings();
        render();
    }

    function toggleHistory() {
        const p = document.getElementById('historyPanel');
        p.style.display = p.style.display === 'block' ? 'none' : 'block';
        if (p.style.display === 'block') updateHistoryUI();
    }

    function updateHistoryUI() {
        const list = document.getElementById('historyList');
        list.innerHTML = resultHistory.length === 0 ? "<p style='text-align:center;color:#444;margin-top:50px;'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>" : "";
        resultHistory.slice().reverse().forEach(item => {
            const div = document.createElement('div');
            div.className = `history-item ${item.isWin ? 'history-win' : 'history-loss'}`;
            div.innerHTML = `
                <div>
                    <span style="color:#666; font-size:11px; display:block; margin-bottom:2px;">ROUND ${item.round}</span>
                    <span style="color:${item.isWin ? 'var(--t-green)' : 'var(--b-red)'}">${item.isWin ? 'WINNER' : 'LOST'} (${item.predict})</span>
                </div>
                <div style="text-align:right;">
                    <div style="font-weight: 800; font-size: 20px;">${item.isWin ? '+' : '-'}${item.amount}</div>
                    <div style="font-size:11px; color:#555;">‡πÑ‡∏°‡πâ ${item.stepIdx}</div>
                </div>
            `;
            list.appendChild(div);
        });
    }

    function reset() {
        if(confirm("üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà?")) {
            logs = []; resultHistory = []; undoStack = []; currentIndex = 0; 
            recoveryMode = false; lockedDNA = -1; blockAfterLoss = false; 
            goalReachedAlerted = false;
            render();
        }
    }

    render();
</script>
</body>
</html>
